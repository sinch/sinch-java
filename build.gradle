plugins {
    id "java-library"
    id "io.freefair.lombok" version "5.3.0"
    id "com.diffplug.spotless" version "5.8.2"
}

repositories {
    mavenLocal()
    jcenter()
}

dependencies {
    implementation "com.fasterxml.jackson.core:jackson-annotations:$jacksonVersion"
    implementation "com.fasterxml.jackson.core:jackson-databind:$jacksonVersion"
    implementation "javax.validation:validation-api:2.0.1.Final"

    testImplementation "org.awaitility:awaitility:4.0.3"
    testImplementation "org.mockito:mockito-core:$mockitoVersion"
    testImplementation "org.mockito:mockito-junit-jupiter:$mockitoVersion"
    testImplementation "org.junit.jupiter:junit-jupiter-api:$junitVersion"
    testRuntimeOnly "org.junit.jupiter:junit-jupiter-engine:$junitVersion"
}

spotless {
    java {
        googleJavaFormat()
        removeUnusedImports()
        trimTrailingWhitespace()
    }
}

afterEvaluate {
    tasks.getByName("build").dependsOn(tasks.getByName("spotlessApply"))
}

test {
    useJUnitPlatform()
}

tasks.withType(Test) {
    systemProperties = System.properties as Map<String, ?>
}

tasks.named("jar") {
    manifest {
        attributes("Implementation-Title": project.name,
                "Implementation-Version": project.version)
    }
}

java {
    withSourcesJar()
    withJavadocJar()
}

version = "0.0.1"