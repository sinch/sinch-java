plugins {
    id "java-library"
    id "io.freefair.lombok" version "5.3.0"
    id "com.diffplug.spotless" version "5.7.0"
}

apply plugin: "io.freefair.lombok"
apply plugin: "com.diffplug.spotless"

repositories {
    mavenLocal()
    jcenter()
}

dependencies {
    implementation "com.fasterxml.jackson.core:jackson-annotations:$jacksonVersion"
    implementation "com.fasterxml.jackson.core:jackson-databind:$jacksonVersion"
    implementation "javax.validation:validation-api:2.0.1.Final"

    testImplementation "org.junit.jupiter:junit-jupiter-api:$junitVersion"
    testRuntimeOnly "org.junit.jupiter:junit-jupiter-engine:$junitVersion"
}

spotless {
    java {
        target project.fileTree(project.projectDir) {
            include "src/**/*.java"
            exclude "build/**/*.*"
        }
        googleJavaFormat()
        removeUnusedImports()
        trimTrailingWhitespace()
    }
}

afterEvaluate {
    tasks.getByName("build").dependsOn(tasks.getByName("spotlessApply"))
}

test {
    useJUnitPlatform()
}

tasks.withType(Test) {
    systemProperties = System.properties as Map<String, ?>
}

tasks.named("jar") {
    manifest {
        attributes("Implementation-Title": project.name,
                "Implementation-Version": project.version)
    }
}

java {
    withSourcesJar()
}

java {
    withJavadocJar()
}

version = "0.0.1"